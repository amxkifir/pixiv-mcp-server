# Pixiv MCP 服务器 - DXT 安装与测试指南

## 📦 构建内容

您的 Pixiv MCP 服务器已成功打包为桌面扩展 (DXT)：

- **文件：** `pixiv-mcp-server-2.0.0.dxt`
- **大小：** 17.3MB（解压后 42.6MB）
- **文件数：** 2,206 个文件，包含所有依赖项
- **格式：** 完整的自包含 DXT 扩展

## 🚀 安装步骤

### 第一步：在 Claude Desktop 中安装

1. **找到 DXT 文件：**
   ```
   D:\新建文件夹 (5)\pixiv-mcp-server\pixiv-mcp-server-2.0.0.dxt
   ```

2. **安装扩展：**
   - 双击 `.dxt` 文件
   - 或拖拽到 Claude Desktop 窗口
   - 或使用 Claude Desktop 的"安装扩展"选项

3. **按照安装提示操作：**
   - Claude Desktop 将验证扩展
   - 出现提示时接受安装

### 第二步：配置扩展

安装后，您需要配置以下设置：

#### 必需配置

**Pixiv 刷新令牌**（必需）
- 使用包含的 `get_token.py` 脚本获取令牌：
  ```bash
  cd "D:\新建文件夹 (5)\pixiv-mcp-server"
  python get_token.py
  ```
- 在浏览器中完成 OAuth 流程
- 复制生成的刷新令牌
- **DXT 专用配置方法：**
  - **推荐：** 使用 `set_refresh_token` 工具进行运行时配置
  - **备选：** 在 Claude Desktop 配置文件中设置环境变量
- **详细配置指南：** 参考 `DXT_TOKEN_配置指南.md`

#### 可选配置

**下载目录**
- 默认：`./downloads`
- 选择您希望保存下载文件的位置
- 如果目录不存在，扩展会自动创建

**文件名模板**
- 默认：`{author} - {title}_{id}`
- 自定义下载文件的命名方式
- 可用变量：`{author}`、`{title}`、`{id}`、`{date}`

**代理 URL**（如果需要）
- 格式：`http://host:port` 或 `https://host:port`
- 仅在企业防火墙后需要时使用

## 🧪 测试安装

### 基本功能测试

1. **打开 Claude Desktop**
2. **开始新对话**
3. **测试基本搜索：**
   ```
   在 Pixiv 上搜索猫咪插画
   ```

4. **预期结果：**
   - Claude 应该使用 `search_illust` 工具
   - 您应该看到猫咪相关艺术作品列表
   - 每个结果应包含标题、艺术家和作品详情

### 高级测试

#### 测试排行榜
```
显示今天 Pixiv 排行榜上的热门插画
```

#### 测试推荐
```
获取一些个性化的艺术作品推荐
```

#### 测试下载（如果已配置）
```
下载 ID 为 12345678 的作品
```

#### 测试用户搜索
```
在 Pixiv 上查找画猫咪的艺术家
```

## 🔧 故障排除

### 常见安装问题

**"扩展安装失败"**
- 确保您使用的是最新版本的 Claude Desktop
- 检查 `.dxt` 文件是否损坏
- 尝试重启 Claude Desktop

**"找不到 Python"**
- 确保安装了 Python 3.10 或更高版本并在 PATH 中
- 扩展包含自己的 Python 环境，但可能需要系统 Python

### 常见配置问题

**"认证失败"**
- 验证刷新令牌是否正确
- 令牌格式应该是一个长的字母数字字符串
- 尝试使用 `get_token.py` 重新生成令牌

**"网络错误"**
- 检查网络连接
- 如果在防火墙后面，配置代理设置
- 验证是否可以从您的位置访问 Pixiv

### 调试模式

启用详细日志记录：
1. 在 Claude Desktop 中，转到扩展设置
2. 添加环境变量：`PIXIV_DEBUG=1`
3. 重启 Claude Desktop
4. 在 Claude Desktop 的开发者控制台中查看日志

## 📋 验证清单

- [ ] DXT 文件成功构建（17.3MB）
- [ ] 扩展在 Claude Desktop 中安装无错误
- [ ] 配置界面显示所有必需字段
- [ ] 获取并配置了 Pixiv 刷新令牌
- [ ] 基本搜索功能正常工作
- [ ] 所有 14 个工具可用且功能正常
- [ ] 下载功能正常工作（如果测试）
- [ ] 错误处理优雅地工作

## 🎯 可用工具摘要

您的 DXT 扩展包含这 15 个工具：

### 搜索与发现
1. `search_illust` - 搜索插画
2. `search_user` - 查找艺术家
3. `illust_ranking` - 浏览排行榜
4. `trending_tags_illust` - 获取热门标签
5. `illust_recommended` - 获取推荐
6. `illust_related` - 查找相关作品

### 下载与管理
7. `download` - 下载艺术作品
8. `download_random_from_recommendation` - 随机下载艺术作品
9. `set_download_path` - 更改下载位置

### 社交功能
10. `illust_follow` - 浏览关注的艺术家
11. `user_bookmarks` - 查看收藏
12. `user_following` - 检查关注列表
13. `illust_detail` - 获取作品详情

### 实用工具
14. `set_refresh_token` - 设置/更新 Pixiv refresh token（DXT 专用）
15. `refresh_token` - 刷新认证

## 🔒 安全功能

- **本地执行** - 所有处理在您的机器上进行
- **安全令牌存储** - 由 Claude Desktop 加密
- **无数据收集** - 无分析或跟踪
- **沙盒环境** - 隔离的 Python 环境

## 📞 支持

如果您遇到问题：

1. **查看本指南** 寻找常见解决方案
2. **查看日志** 在 Claude Desktop 开发者控制台中
3. **先测试简单命令**
4. **验证配置** 设置
5. **报告问题** 如果问题持续存在，请在 GitHub 上报告

## 🎉 使用示例

### 搜索和浏览
```
# 搜索特定主题
搜索"樱花"主题的插画

# 查看排行榜
显示本周的插画排行榜

# 获取推荐
给我一些基于我喜好的艺术推荐
```

### 下载管理
```
# 下载特定作品
下载这个作品：https://www.pixiv.net/artworks/12345678

# 批量下载
下载这些作品 ID：12345678, 87654321, 11223344

# 设置下载路径
将下载文件夹设置为 D:/我的Pixiv收藏
```

### 用户和社交
```
# 查找艺术家
找一些画动漫风格的艺术家

# 查看用户作品
显示用户 ID 123456 的最新作品

# 浏览关注动态
显示我关注的艺术家的最新作品
```

---

**恭喜！** 您的 Pixiv MCP 服务器现在已打包为专业的 DXT 扩展，可以在 Claude Desktop 中分发和使用。